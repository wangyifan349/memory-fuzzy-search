# 🧐 内存中模糊搜索工具

> 这是一款**纯 Python 实现**的模糊搜索工具，帮助你在程序内存中的**大量文本和代码**里快速查找相似内容。  
> 支持最长公共子序列（LCS）和编辑距离（Levenshtein）两种算法，自动忽略大小写，无任何外部依赖 🎉

---

## 🚀 功能亮点

- 🔎 支持多行字符串整体模糊搜索  
- 🧩 支持多行字符串拆行逐行模糊搜索，精准定位匹配行  
- 🎯 提供两种经典相似度算法：最长公共子序列（LCS）和编辑距离（Levenshtein）  
- 🐍 纯Python实现，轻量无依赖，便于集成与扩展  
- ⚙ 支持为数据项指定ID或标签，方便检索结果的快速定位  
- 📈 返回匹配相似度分数，支持阈值过滤控制匹配严格度  

---

## 🧠 工作流程（ASCII 图示）

```
┌───────────────┐
│ 输入搜索关键词   │
└──────┬────────┘
       │
       ▼
┌───────────────┐
│ 加载内存中的数据 │
└──────┬────────┘
       │
       ▼
┌───────────────┐
│ 选择相似度算法 │
│ ┌───────────┐ │
│ │ LCS算法    │ │
│ └───────────┘ │
│ ┌───────────┐ │
│ │ 编辑距离算法│ │
│ └───────────┘ │
└──────┬────────┘
       │
       ▼
┌───────────────┐
│ 计算关键词与每条数据的相似度 │
└──────┬────────┘
       │
       ▼
┌───────────────┐
│ 过滤相似度低于阈值的结果 │
└──────┬────────┘
       │
       ▼
┌───────────────┐
│ 按相似度降序排序结果 │
└──────┬────────┘
       │
       ▼
┌───────────────┐
│ 返回匹配结果列表 │
└───────────────┘
```

---

## 🔍 相关算法说明（示例）

### 最长公共子序列（LCS）

- 用于找两个字符串中**顺序相同的最长公共部分**，顺序必须不变但允许不连续。  
- 例子：  
  ```
  s1 = "abcde"
  s2 = "ace"
  LCS = "ace" 长度3
  ```
  
### 编辑距离（Levenshtein）

- 计算一个字符串转化为另一个所需的最小编辑操作数量（插入、删除、替换）  
- 例子：  
  ```
  s1 = "kitten"
  s2 = "sitting"
  编辑距离 = 3
  ```
  
---

## 🎯 使用简介

### 数据格式

- 纯字符串列表示例  
  ```python
  [ "文本一段", "另一段代码", ... ]
  ```  
- 含标识符的元组列表示例  
  ```python
  [ ("id1", "文本内容"), ("code2", "代码内容") ]
  ```

### 函数调用

| 功能                      | 函数名                        | 说明                              |
|-------------------------|----------------------------|---------------------------------|
| 对整条字符串整体模糊搜索        | `fuzzy_search_in_memory`     | 多行字符串整体匹配                      |
| 对多行字符串拆行逐行模糊搜索      | `fuzzy_search_multiline_lines` | 拆分行匹配，定位具体匹配行                 |

### 主要参数

| 参数        | 含义                       | 示例                 |
|-----------|--------------------------|--------------------|
| `data`    | 内存中待搜索的字符串或（id，字符串） | `[ "文本", ("code1", "代码") ]` |
| `query`   | 搜索关键词                    | `"def function"`       |
| `threshold` | 匹配相似度阈值 (0~1)          | `0.7`                |
| `method`  | 选用的算法 `"lcs"` 或 `"levenshtein"` | `"levenshtein"`        |

---

## 🛠️ 示例代码

```python
dataset = [
    "def my_function(x):\n  print(x)\n  return x * 2",
    ("code1", "def my_funtion(y):\n  print(y)\n  return y + 1"),
    "示例文本\n多行内容"
]

query = "def my_function"

# 整体模糊搜索（LCS）
results = fuzzy_search_in_memory(dataset, query, threshold=0.6, method="lcs")
for id_, text, score in results:
    print(f"匹配ID/索引: {id_}，相似度: {score:.2f}")
    print(text)
    print("-" * 20)

# 逐行拆行模糊搜索（编辑距离）
results_lines = fuzzy_search_multiline_lines(dataset, query, threshold=0.6, method="levenshtein")
for id_, line_no, line_text, score in results_lines:
    print(f"匹配ID/索引: {id_}，行号: {line_no}，相似度: {score:.2f}")
    print(line_text)
    print("-" * 20)
```

---

## ⚠️ 注意事项

- 比较时自动统一转为小写，忽略大小写影响  
- 整体长文本计算相似度比逐行慢，建议大文本用拆行搜索提升效率  
- 适当调整阈值控制匹配灵敏度，范围一般为 0.5~0.9  
- 冒泡排序适合中小数据，数据量大时建议改进排序或搜索算法  

---

## 📦 环境

- Python 3.x  
- 无需额外依赖，完全纯Python

---

## 🙏 谢谢使用！

